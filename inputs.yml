# Define if the installation should be done in offline mode (no access to internet from the hosts)
offline: false
# optionnal domain to add to host names in private communications
#private_domain_name: alien4cloud.priv
# this DNS resolver will be added to Nginx config
#dns_resolver: 172.31.0.2

# A4C
a4c_user: a4c
a4c_install_dir: /opt/a4c
a4c_working_dir: /opt/a4c/workdir
# This is the work folder for a4c, should be a mount point (shared volume) in case of HA
#a4c_working_dir: /mnt/a4c/runtime
# a4c_log_dir: /var/log/a4c
# a4c_protocol: https
a4c_tls: false
a4c_port: 8088
a4c_front_protocol: http
#a4c_front_location_path: /a4c
#a4c_url_path: /a4c
# WARNING : use 80 for http and 443 for SSL
# We have issues running correctly A4C behind a proxy
a4c_front_port: 80
a4c_admin_usr: admin
a4c_admin_pwd: admin
a4c_saml_enabled: false
a4c_jvm_jmx_remote_enabled: true
# a4c_saml_config_url: https://keycloak/auth/realms/artemis/protocol/saml/descriptor
inventory_dir: "../"

consul_user: consul
consul_install_dir: /opt/consul
consul_http_port: 8500
# If true the Gossip protocol will we encrypted
consul_gossip_encrypt: true
# If Gossip is encrypted, the path where the key will be found
# The key is generated on a consul node in the role roles/consul/configure-consul-gossip-keygen
# It's copied in this local folder and used on all nodes
consul_gossip_encrypt_key_path: certificates/consul_encrypt_key
# If true, consul http channels will be secured using TLS (certificates nedded)
consul_tls: false
a4cfront_consul_tls: false
consul_use_localhost_as_client_addr: false
a4cfront_consul_use_localhost_as_client_addr: false
yorcfront_consul_use_localhost_as_client_addr: false
consul_front_protocol: https

yorc_user: yorc
yorc_install_dir: /opt/yorc
# This is the work folder for yorc, should be a mount point (shared volume) in case of HA
#yorc_working_dir: /mnt/yorc/work
# If true yorc http server will be secured using TLS (certificates nedded)
yorc_tls: false
yorc_debug: 0
yorc_remote_ansible_tmp: /tmp/ansible/remote
yorc_local_ansible_tmp: /tmp/ansible/local
discriminator: ART_YORK_

jmeter_user: jmeter
jmeter_install_dir: /opt/jmeter

# Inidicates of TLS should be activated for ES cluster
elasticsearch_tls: false
# ES data directory if not default
# elasticsearch_home: /var/lib/elasticsearch

# SSL TLS
# The local path where certificates can be found for SSL configs on nodes
certificates_path: certificates/
ca_passphrase: dontChangeIt
ssl_keystore_source_location: /var/folders/2d/3krvvvn538ggxjx8mtvwmj_c0000gn/T/tmp.vaCqIRYH/server-keystore.p12
ssl_src_keystore_password: changeit
ssl_dest_keystore_password: changeit
ssl_key_password: changeit
# ssl_ca_cert_name: "artemis_ca.pem.txt"
# ssl_host_key_suffix: ".technique.artemis.pem.txt"
# ssl_host_cert_suffix: ".technique.artemis.crt.txt"

elasticsearch_rmp_url: https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-6.6.2.rpm
ALIEN_DIST_URL: http://nexus.artemis.public/repository/Artemis-Raw/infostructure/socle/service-applicatif/a4c/alien4cloud-artemis-dist-3.0.0-M6-dist.tar.gz
#ALIEN_DIST_URL: http://34.242.40.25/dist/alien4cloud/alien4cloud-premium-dist/3.0.0-SNAPSHOT/alien4cloud-premium-dist-3.0.0-SNAPSHOT-dist.tar.gz
JAVA_DIST_URL: http://download.oracle.com/otn-pub/java/jdk/8u131-b11/d54c1d3a095b4ff2b6607d096fa80163/jdk-8u131-linux-x64.tar.gz
#CONSUL_DIST_URL: https://releases.hashicorp.com/consul/1.2.3/consul_1.2.3_linux_amd64.zip
#YORC_DIST_URL: https://bintray.com/ystia/yorc-engine/download_file?file_path=4.0.0-M10%2Fyorc-4.0.0-M10.tgz
#JMETER_DIST_URL: https://archive.apache.org/dist/jmeter/binaries/apache-jmeter-3.1.tgz
#TERRAFORM_DIST_URL: https://releases.hashicorp.com/terraform/0.11.8/terraform_0.11.8_linux_amd64.zip
#CONSUL_TEMPLATE_DL_URL: https://releases.hashicorp.com/consul-template/0.23.0/consul-template_0.23.0_linux_amd64.zip
CONSUL_DIST_URL: http://nexus.artemis.public/repository/Artemis-Raw/infostructure/socle/service-applicatif/consul/consul_1.2.3_linux_amd64.zip
YORC_DIST_URL: http://nexus.artemis.public/repository/Artemis-Raw/infostructure/socle/service-applicatif/yorc/yorc-4.0.0-M10.tgz
TERRAFORM_DIST_URL: http://nexus.artemis.public/repository/Artemis-Raw/infostructure/socle/service-applicatif/terraform/terraform_0.11.8_linux_amd64.zip
CONSUL_TEMPLATE_DL_URL: http://nexus.artemis.public/repository/Artemis-Raw/infostructure/socle/service-applicatif/consul/consul-template_0.23.0_linux_amd64.zip
spark_download_url: http://nexus.artemis.public/repository/Artemis-Raw/infostructure/plateforme/spark-2.4.4-bin-hadoop2.7.tgz

terraform_plugins:
  - http://nexus.artemis.public/repository/Artemis-Raw/infostructure/socle/service-applicatif/terraform/plugins//terraform-provider-aws_1.36.0_linux_amd64.zip
  - http://nexus.artemis.public/repository/Artemis-Raw/infostructure/socle/service-applicatif/terraform/plugins//terraform-provider-openstack_1.9.0_linux_amd64.zip
  - http://nexus.artemis.public/repository/Artemis-Raw/infostructure/socle/service-applicatif/terraform/plugins//terraform-provider-consul_2.1.0_linux_amd64.zip
  - http://nexus.artemis.public/repository/Artemis-Raw/infostructure/socle/service-applicatif/terraform/plugins//terraform-provider-google_1.18.0_linux_amd64.zip
  - http://nexus.artemis.public/repository/Artemis-Raw/infostructure/socle/service-applicatif/terraform/plugins/terraform-provider-null_1.0.0_linux_amd64.zip
yorc_dependencies_rpm_urls:
  - http://nexus.artemis.public/repository/EPEL7/Packages/j/jq-1.5-1.el7.x86_64.rpm
  - http://nexus.artemis.public/repository/EPEL7/Packages/o/oniguruma-5.9.5-3.el7.x86_64.rpm
  - http://nexus.artemis.public/repository/Artemis-Raw/infostructure/socle/service-applicatif/python/ansible-2.7.9-1.el7.ans.noarch.rpm
  - http://nexus.artemis.public/repository/CentOS7-Extras/Packages/sshpass-1.06-2.el7.x86_64.rpm
  - http://nexus.artemis.public/repository/CentOS7-Extras/Packages/python2-jmespath-0.9.0-3.el7.noarch.rpm
  - http://nexus.artemis.public/repository/EPEL7/Packages/p/python2-passlib-1.7.1-1.el7.noarch.rpm
  - http://nexus.artemis.public/repository/CentOS7/Packages/python2-cryptography-1.7.2-2.el7.x86_64.rpm
  - http://nexus.artemis.public/repository/CentOS7/Packages/python-paramiko-2.1.1-9.el7.noarch.rpm
  - http://nexus.artemis.public/repository/CentOS7-Extras/Packages/python-httplib2-0.9.2-1.el7.noarch.rpm
  - http://nexus.artemis.public/repository/CentOS7/Packages/scl-utils-20130529-19.el7.x86_64.rpm
  - http://nexus.artemis.public/repository/Artemis-Raw/infostructure/socle/service-applicatif/python/python27-runtime-1.1-26.1.el7.x86_64.rpm
  - http://nexus.artemis.public/repository/Artemis-Raw/infostructure/socle/service-applicatif/python/python27-python-setuptools-0.9.8-7.el7.noarch.rpm
  - http://nexus.artemis.public/repository/Artemis-Raw/infostructure/socle/service-applicatif/python/python27-python-pip-8.1.2-3.el7.noarch.rpm
  - http://nexus.artemis.public/repository/Artemis-Raw/infostructure/socle/service-applicatif/python/python27-python-libs-2.7.16-4.el7.x86_64.rpm
  - http://nexus.artemis.public/repository/Artemis-Raw/infostructure/socle/service-applicatif/python/python27-python-2.7.16-4.el7.x86_64.rpm
  - http://nexus.artemis.public/repository/CentOS7/Packages/python-cffi-1.6.0-5.el7.x86_64.rpm
  - http://nexus.artemis.public/repository/CentOS7/Packages/python-enum34-1.0.4-1.el7.noarch.rpm
  - http://nexus.artemis.public/repository/CentOS7/Packages/python-idna-2.4-1.el7.noarch.rpm
  - http://nexus.artemis.public/repository/CentOS7/Packages/python-ply-3.4-11.el7.noarch.rpm
  - http://nexus.artemis.public/repository/CentOS7/Packages/python-pycparser-2.14-1.el7.noarch.rpm
  - http://nexus.artemis.public/repository/CentOS7/Packages/python2-pyasn1-0.1.9-7.el7.noarch.rpm
  - http://nexus.artemis.public/repository/Kubernetes/Packages/8425067aee8e57b64d3eff0d78817c30e486d58a6b749fa55a46366bb9addb7e-kubectl-1.14.3-0.x86_64.rpm



# A4C Config
a4c_version: 3.0.0-M6
# kube_config: toto
#topologyTemplateVersionId: "3MockWithRel:2.1.0-SNAPSHOT"
#applicationName: SetupTest

# a4c_upgrade_plugins: []
#   - alien4cloud-kubernetes-plugin
#   - alien4cloud-ssi-network_policy-plugin
should_use_rsync_for_a4c_ha: true
should_use_rsync_for_yorc_ha: true

use_localhost_for_local_connections: false

# This piece of config will be added to a4c condfiguration
a4c_config_addons:
  languages:
    default: fr-fr
    prefix: artemis
  consul:
    url: http://localhost:8500
    command: "echo TESTFCH"
  features:
    auto_simplify_workflows: false
  datagouv_mls:
    # TODO: kk80-1.artemis.public
    # kafkaServers: mstech-kk80-vm-1.artemis.public:9093,mstech-kk80-vm-2.technique.artemis:9093,mstech-kk80-vm-3.technique.artemis:9093
    # topic: a4c-atlas
    # moduleDeleteCredentials: a4c:a4c
    # moduleDeleteUrl: http://localhost:8500/v1/kv
    # TODO: tec-atlas-a4c:V7SD953s8mFOJyUQ4SwyJIRMhmtoXPARMrK

    # SMD (MLS / PDS)
    # tec-smd-a4c // tMoqZ0kPECE6YQnbrO7AVHXgl2HwzGVlfoE
    applicationPostCredentials: a4c:a4c
    # TODO: smd.priv.artemis:443
    applicationPostUrl: https://10.197.214.173:8080/pds/instanciated/application/create/inputentities
    # TODO : Vault ?
    getPdsCredentials: a4c:a4c
    # TODO: smd.priv.artemis:443
    getPdsUrl: https://10.197.214.173:8080/pds/instanciated/application/get/

    # ATLAS
    # tec-atlas-a4c // V7SD953s8mFOJyUQ4SwyJIRMhmtoXPARMrK
    applicationDeleteCredentials: admin:admin
    # TODO : atlas.artemis.public:21443
    applicationDeleteAppliUrl: http://10.197.214.173:21000/api/atlas/v2/entity/uniqueAttribute/type/artemis_application_instance?attr:qualifiedName=
    applicationDeleteModuleUrl: http://10.197.214.173:21000/api/atlas/v2/entity/uniqueAttribute/type/artemis_module_instance?attr:qualifiedName=

    # Url de redirection
    # TODO: smd.artemis.public:443
    pdsIhmUrl: https://10.197.214.173/smd/create-pds-application?qname=
  kafka-listener:
    # TODO: kk80-1.artemis.public
    bootstrap-servers: kafka-1.artemis.public:9092,kafka-2.artemis.public:9092,kafka-3.artemis.public:9092
    iput-topic: a4c-in
    output-topic: a4c-out
  supervision:
    # TODO: kk80-1.supervision.artemis
    bootstrap-servers: kafka-1.artemis.public:9092,kafka-2.artemis.public:9092,kafka-3.artemis.public:9092
    site: default
    topic: logs-deployment-a4c
    module-tag-name: "Type de composant"
    module-tag-value: "Module"
    meta-prefix: "supervision"
  wizard:
    application-overview-metaproperties:
      - "Mention de manipulation"
      - "Habilitation requise"
    component-overview-metaproperties:
      - "Type de composant"
    component-filter-by-metaproperty-values:
      "Modules":
        "Type de composant": "Module"
      "Espaces de stockage":
        "Type de composant": "Espace_De_Stockage_Echange"


# PLugins can be disabled by configuration
# a4c_disabled_plugins:
#   - alien4cloud-ssi-network_policy-plugin
#   - alien4cloud-consul-publisher-plugin
#   - alien4cloud-datagouv_mls-plugin
#   - alien4cloud-ssi-network_policy-plugin
#   - kubernetes-supervision-modifier
#   - alien4cloud-kafka-listener

orchestrator_config:
  Yorc:
    Default:
      location_modifiers:
        - pluginId: 'alien4cloud-consul-publisher-plugin'
          beanName: 'consul-notifier'
          phase: 'pre-node-match'
          modifier_position: 0
        - pluginId: 'alien4cloud-yorc-provider'
          beanName: 'gangja-resolver-modifier'
          phase: 'post-node-match'
          modifier_position: 1
        - pluginId: 'alien4cloud-datagouv_mls-plugin'
          beanName: 'datagouv_mls-modifier'
          phase: 'post-matched-node-setup'
          modifier_position: 2
        - pluginId: 'alien4cloud-kubernetes-plugin'
          beanName: 'kubernetes-adapter-modifier'
          phase: 'post-matched-node-setup'
          modifier_position: 3
        - pluginId: 'alien4cloud-consul-publisher-plugin'
          beanName: 'consul-publisher'
          phase: 'post-matched-node-setup'
          modifier_position: 4
        - pluginId: 'alien4cloud-ssi-network_policy-plugin'
          beanName: 'ssi-network_policy-modifier'
          phase: 'post-matched-node-setup'
          modifier_position: 5
        - pluginId: 'alien4cloud-k8s-spark-jobs'
          beanName: 'k8s-spark-jobs-modifier'
          phase: 'post-matched-node-setup'
          modifier_position: 6
        - pluginId: 'alien4cloud-supervision'
          beanName: 'kubernetes-supervision-modifier'
          phase: 'post-matched-node-setup'
          modifier_position: 7
        - pluginId: 'alien4cloud-yorc-provider'
          beanName: 'yorc-wf-operation-host-modifier'
          phase: 'post-matched-node-setup'
          modifier_position: 8
        - pluginId: 'alien4cloud-yorc-provider'
          beanName: 'yorc-service-topology-modifier'
          phase: 'post-matched-node-setup'
          modifier_position: 9
        - pluginId: 'alien4cloud-yorc-provider'
          beanName: 'yorc-location-modifier'
          phase: 'post-matched-node-setup'
          modifier_position: 10


# Id of template to deploy at test stage (end of setup)
topologyTemplateVersionId: "1TinyMock:2.1.0-SNAPSHOT"
applicationName: "SetupTestApp"

force_delete_files: true
